<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğ¾ğ‘–ğ‘š ğ½ğ‘ğ‘’ ğ‘Šğ‘œğ‘›</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&family=Nanum+Pen+Script&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            margin: 0;
            overflow: hidden;
            background-color: #1a1a1a;
            color: white;
            user-select: none;
        }

        .handwriting {
            font-family: 'Nanum Pen Script', cursive;
        }

        .scene {
            position: absolute;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            overflow: hidden;
        }

        #start-scene {
            background: radial-gradient(circle at 50% 50%, #2c3e50, #000);
            z-index: 10;
            transition: opacity 0.5s;
        }

        .wall-bg {
            position: absolute; width: 100%; height: 70%; top: 0;
            background: #222;
        }
        .floor-bg {
            position: absolute; width: 100%; height: 30%; bottom: 0;
            background: #4e342e;
            border-top: 10px solid #3e2723;
        }
        
        .window {
            position: absolute; top: 10%; left: 10%;
            width: 200px; height: 300px;
            background: #001; border: 10px solid #333;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }
        .moon {
            position: absolute; top: 30px; right: 30px;
            width: 50px; height: 50px; background: #ffeb3b;
            border-radius: 50%; box-shadow: 0 0 30px #ffeb3b;
        }

        .blackboard {
            position: absolute; top: 15%; right: 10%;
            width: 400px; height: 250px;
            background: #143622; border: 12px solid #5d4037;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.5);
            display: flex; justify-content: center; align-items: center;
            font-size: 1.5rem; color: rgba(255,255,255,0.7);
        }

        .student-container {
            position: absolute; bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 300px; height: 400px;
        }
        .s-head {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 120px; height: 130px; background: #fff;
            border-radius: 60px; z-index: 5;
        }
        .s-body {
            position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 220px; height: 200px; background: #fff;
            border-radius: 50px 50px 0 0; z-index: 4;
        }
        .s-desk {
            position: absolute; bottom: -50px; left: 50%; transform: translateX(-50%);
            width: 400px; height: 150px; background: #5d4037;
            border-radius: 10px; z-index: 3;
        }

        .main-menu {
            position: absolute; right: 5%; bottom: 15%;
            display: flex; flex-direction: column; gap: 20px;
            align-items: center;
        }
        .menu-btn {
            width: 300px; height: 80px;
            border: 3px solid white;
            background: rgba(0,0,0,0.7);
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex; align-items: center; justify-content: center;
        }
        .menu-btn:hover {
            background: white; color: black; transform: scale(1.05);
        }

        .volume-control {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 300px;
            margin-top: 10px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
        }
        .vol-label {
            font-weight: 400;
            font-size: 1rem;
            color: white;
            margin-bottom: 10px;
            text-shadow: 1px 1px 2px black;
            text-align: center;
            width: 100%;
        }
        .vol-slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
        }
        input[type=range] {
            -webkit-appearance: none;
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #ffffff;
            cursor: pointer;
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        input[type=range]::-moz-range-thumb {
            width: 16px; height: 16px; border: none; border-radius: 50%; background: #ffffff; cursor: pointer;
        }
        input[type=range]::-moz-range-track {
            width: 100%; height: 4px; background: rgba(255, 255, 255, 0.5);
        }

        #game-scene {
            display: none;
            background: black; 
        }

        #game-content {
            width: 100%; height: 100%;
            background: #3e2723;
            transition: filter 0.5s ease;
        }
        
        .dark-filter {
            filter: brightness(0.6);
        }
        
        .dark-filter #quiz-paper {
            filter: brightness(1.58333);
        }

        #damage-overlay {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: rgba(100, 0, 0, 1);
            opacity: 0;
            pointer-events: none;
            z-index: 50;
            transition: opacity 0.5s ease;
            mix-blend-mode: multiply;
        }

        .desk-mat {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle, #5d4037 0%, #3e2723 80%);
            display: flex; justify-content: center; align-items: center;
        }

        .paper {
            width: 500px; min-height: 650px;
            background: #fff;
            box-shadow: 10px 10px 30px rgba(0,0,0,0.5);
            padding: 50px 40px;
            color: #222;
            position: relative;
            display: flex; flex-direction: column;
        }
        .paper::before {
            content: ''; position: absolute; top: 0; left: 60px;
            width: 2px; height: 100%; background: #ffcccc;
        }

        #cheat-paper {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 460px;
            min-height: 400px;
            background: #fdfbf7;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
            padding: 30px;
            z-index: 10;
            display: none;
            transform: rotate(-2deg);
            border: 1px solid #ddd;
        }
        .cheat-close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #888;
            cursor: pointer;
        }
        .cheat-answer {
            color: red;
            font-family: 'Nanum Pen Script', cursive;
            font-size: 2.5rem;
            text-align: center;
            margin-top: 10px;
        }

        .question-area {
            margin-top: 20px;
            flex-grow: 1;
        }

        .answer-box {
            border-bottom: 2px solid #222;
            margin-top: 30px;
            position: relative;
        }
        input[type="text"] {
            width: 100%;
            border: none; outline: none;
            font-family: 'Nanum Pen Script', cursive;
            font-size: 2.5rem;
            color: #000;
            background: transparent;
            text-align: center;
        }

        #timer-ui {
            position: absolute;
            top: 20px; right: 20px;
            width: 80px; height: 80px;
            border: 4px solid #fff;
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem;
            font-weight: bold;
            background: rgba(0,0,0,0.5);
            color: white;
            z-index: 20;
            box-shadow: 0 0 10px rgba(255,255,255,0.3);
        }
        #timer-ui.warning {
            border-color: #ff0000;
            color: #ff0000;
            animation: pulse 1s infinite;
        }

        #cheat-btn {
            position: absolute;
            top: 120px; right: 20px;
            background: rgba(0,0,0,0.5);
            border: 2px solid white;
            color: white;
            padding: 8px 15px;
            font-size: 0.9rem;
            cursor: pointer;
            z-index: 20;
            transition: 0.3s;
        }
        #cheat-btn:hover {
            background: white;
            color: black;
        }

        .modal-overlay {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex; justify-content: center; align-items: center;
            z-index: 30;
        }
        .modal-content {
            border: 2px solid white;
            padding: 40px;
            text-align: center;
            background: black;
            max-width: 600px;
        }
        .diff-btn {
            display: inline-block;
            width: 200px; padding: 20px;
            margin: 10px;
            border: 2px solid #555;
            cursor: pointer;
            transition: 0.3s;
        }
        .diff-btn:hover { border-color: white; background: #333; }

        #jumpscare-overlay {
            position: absolute; top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: 100;
            display: none;
            background: black;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #jumpscare-img {
            width: 100%; height: 100%;
            object-fit: contain;
        }

        #game-over-screen {
            position: absolute; top: 0; left: 0;
            width: 100vw; height: 100vh;
            background: rgba(100, 0, 0, 0.9);
            z-index: 90;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            display: none;
        }
        .game-over-btn {
            border: 2px solid white;
            padding: 15px 30px;
            margin: 10px;
            font-size: 1.5rem;
            color: white;
            background: transparent;
            cursor: pointer;
            transition: 0.3s;
        }
        .game-over-btn:hover { background: white; color: #500; }

        .hidden { display: none !important; }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
        .shake { animation: shake 0.5s; }
    </style>
</head>
<body>
    <audio id="bgm" loop>
        <source src="https://raw.githubusercontent.com/o-mega-0/KJW_Volume/main/Volume.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx-wrong">
        <source src="https://raw.githubusercontent.com/o-mega-0/KJW_Wrong-Answer/main/Wrong%20Answer.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx-dead">
        <source src="https://raw.githubusercontent.com/o-mega-0/KJW_Dead/main/dead.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx-ending">
        <source src="https://raw.githubusercontent.com/o-mega-0/KJW_Ending/main/Ending.mp3" type="audio/mp3">
    </audio>
    <audio id="sfx-volume">
        <source src="https://raw.githubusercontent.com/o-mega-0/KJW_Volume/main/Volume.mp3" type="audio/mp3">
    </audio>

    <div id="jumpscare-overlay" class="hidden">
        <img id="jumpscare-img" src="" alt="scare">
    </div>

    <div id="game-over-screen">
        <h1 class="text-7xl font-bold text-black mb-10 drop-shadow-lg" style="text-shadow: 0 0 10px red;">ë‹¹ì‹ ì€ ì£½ì—ˆìŠµë‹ˆë‹¤</h1>
        <div>
            <div class="game-over-btn" onclick="retryGame()">ë‹¤ì‹œ í”Œë ˆì´</div>
            <div class="game-over-btn" onclick="location.reload()">ì²˜ìŒìœ¼ë¡œ</div>
        </div>
    </div>

    <div id="start-scene" class="scene">
        <div class="wall-bg">
            <div class="window">
                <div class="moon"></div>
            </div>
            <div class="blackboard">
                <span>10.13.<br> <br>ë‹¹ë²ˆ: ê¹€ì¬ì›<br>ì—°ì• : ê¹€ì¬ì›&ê²Œë Œ</span>
            </div>
        </div>
        <div class="floor-bg"></div>
        <div class="student-container">
            <div class="s-head"></div>
            <div class="s-body"></div>
            <div class="s-desk"></div>
        </div>
        <div class="absolute top-10 left-10">
            <h1 class="text-7xl font-bold tracking-widest text-white drop-shadow-lg" style="text-shadow: 4px 4px 0px #000;">ğ¾ğ½ğ‘Š</h1>
        </div>
        
        <div class="main-menu">
            <div class="menu-btn" onclick="openDifficulty()">ê²Œì„ ì‹œì‘</div>
            <div class="menu-btn" onclick="openHowTo()">ê²Œì„ ë°©ë²•</div>

            <div class="volume-control">
                <div class="vol-label">ë³¼ë¥¨ì„ ë“£ê¸° ì¢‹ê²Œ ì¡°ì ˆí•´ì£¼ì„¸ìš”</div>
                <div class="vol-slider-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white">
                        <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                    </svg>
                    <input type="range" id="vol-slider" min="0" max="1" step="0.01" value="0.5">
                </div>
            </div>
        </div>
    </div>

    <div id="game-scene" class="scene">
        <div id="damage-overlay"></div>

        <div id="game-content">
            <div id="timer-ui">60</div>
            <button id="cheat-btn" onclick="openCheatSheet()">ë‹µì§€ ë³´ê¸°</button>
            
            <div class="desk-mat">
                <div id="quiz-paper" class="paper hidden">
                    <h2 class="text-3xl font-bold text-center border-b-2 border-gray-300 pb-4 mb-4">íƒêµ¬ ìƒí™œ</h2>
                    
                    <div class="text-right text-gray-500 mb-2">
                        <span id="q-num" class="font-bold text-red-600 text-xl">1</span> / 15
                    </div>

                    <div class="question-area">
                        <p id="q-text" class="text-2xl font-bold leading-relaxed mb-4 break-keep"></p>
                        <p id="q-condition" class="text-lg text-gray-500 mb-8 break-keep"></p>
                        
                        <div class="answer-box">
                            <input type="text" id="answer-input" placeholder="ì •ë‹µ ì‘ì„±" autocomplete="off">
                        </div>
                        <div class="text-right mt-2">
                            <button onclick="checkAnswer()" class="text-gray-400 hover:text-red-600 text-lg font-bold">ì œì¶œ &gt;</button>
                        </div>
                    </div>

                    <div id="cheat-paper">
                        <div class="cheat-close-btn" onclick="closeCheatSheet()">X</div>
                        <h2 class="text-3xl font-bold text-center border-b-2 border-gray-300 pb-4 mb-4" style="color: #555;">[í•´ì„¤ì§€]</h2>
                        <div class="question-area">
                            <p id="cheat-q-text" class="text-2xl font-bold leading-relaxed mb-4 break-keep" style="color: #333;"></p>
                            <p id="cheat-q-condition" class="text-lg text-gray-500 mb-8 break-keep"></p>
                            
                            <div class="answer-box">
                                <div id="cheat-answer-display" class="cheat-answer"></div>
                            </div>
                        </div>
                        <p style="position: absolute; bottom: 5px; right: 8px; font-size: 8px; color: #d1d5db; margin: 0;">20% í™•ë¥ ë¡œ ê°€ì§œì…ë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="howto-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-3xl text-yellow-400 mb-6 font-bold">í™˜ì˜í•©ë‹ˆë‹¤!</h2>
            <p class="text-xl mb-2">ì´ ê²Œì„ì€ ê¹€ì¬ì›ë‹˜ê³¼ ê´€ë ¨ëœ</p>
            <p class="text-xl mb-8">ë¬¸ì œ 15ê°œë¥¼ ë§ì¶”ê¸°ë§Œ í•˜ë©´ ë˜ëŠ” ê°„ë‹¨í•œ ê²Œì„ì…ë‹ˆë‹¤^^</p>
            <p class="text-2xl font-bold text-green-400 mb-8">í–‰ìš´ì„ ë¹•ë‹ˆë‹¤!</p>
            <button onclick="closeModal('howto-modal')" class="border border-white px-8 py-2 mt-6 hover:bg-white hover:text-black">í™•ì¸</button>
        </div>
    </div>

    <div id="diff-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 800px;">
            <h2 class="text-3xl mb-10 font-bold">ë‚œì´ë„ ì„ íƒ</h2>
            <div class="flex justify-center">
                <div class="diff-btn group" onclick="startGame('normal')">
                    <h3 class="text-2xl font-bold mb-2">Normal</h3>
                    <p class="text-gray-400 group-hover:text-white text-sm">ì¡°íšŒìˆ˜ê°€ ì•ˆ ë‚˜ì˜µë‹ˆë‹¤</p>
                </div>
                <div class="diff-btn group" onclick="startGame('hard')">
                    <h3 class="text-2xl font-bold mb-2 text-red-500">Hard</h3>
                    <p class="text-gray-400 group-hover:text-white text-sm">ì¡°íšŒìˆ˜ê°€ ì˜ ë‚˜ì˜µë‹ˆë‹¤</p>
                </div>
            </div>
        </div>
    </div>

    <div id="ending-screen" class="modal-overlay hidden">
        <div class="text-center">
            <h1 class="text-6xl text-yellow-400 mb-4 font-bold animate-bounce">ì¶•í•˜í•©ë‹ˆë‹¤!</h1>
            <p class="text-lg text-gray-500 mb-12">by. ì´ë¦„ë­ë¡œí•˜ì§€</p>
            <div class="flex flex-col gap-4 justify-center items-center">
                <button onclick="location.reload()" class="border-2 border-white text-white px-10 py-3 text-xl hover:bg-white hover:text-black font-bold w-80">ì²˜ìŒìœ¼ë¡œ</button>
                <button id="other-diff-btn" class="border-2 border-gray-400 text-gray-300 px-10 py-3 text-xl hover:bg-gray-700 hover:text-white font-bold w-80">
                </button>
            </div>
        </div>
    </div>

    <script>
        const preloadImages = ['wrong-answer.png', 'dead.png', 'slow.png', 'caught.png'];
        preloadImages.forEach(src => {
            const img = new Image();
            img.src = src;
        });

        const commonQuestions = [
            { q: "ê¹€ì¬ì›ì˜ êµ­ì ì€?", c: "", a: ["ëŒ€í•œë¯¼êµ­"], fa: "ëŒ€í•œë¯¼êµ­" },
            { q: "ê¹€ì¬ì›ì˜ í˜ˆì•¡í˜•ì€?", c: "(ë‹¨, ì˜ì–´ë§Œ ëŒ€ë¬¸ìë¡œ ì“´ë‹¤)", a: ["A"], fa: "Aí˜•" },
            { q: "ê¹€ì¬ì›ì˜ MBTIëŠ”?", c: "(ë‹¨, ëŒ€ë¬¸ìë¡œ ì“´ë‹¤)", a: ["ENFP"], fa: "ENFP" },
            { q: "ê¹€ì¬ì›ì˜ í‚¤ëŠ”?", c: "(ë‹¨, ìˆ«ìë§Œ ì“´ë‹¤)", a: ["174"], fa: "175" },
            { q: "ê¹€ì¬ì›ì˜ ìƒì¼ì€?", c: "(ë‹¨, 8ìë¦¬ë¡œ ì“´ë‹¤)", a: ["19980622"], fa: "1998622" },
            { 
                q: "ê¹€ì¬ì› ì›ƒìŒì°¸ê¸° ì½˜í…ì¸ ì—ì„œ ì¹˜íŠ¸í‚¤ëŠ”?", 
                c: "(ë‹¨, í•œê¸€ë¡œ ì“´ë‹¤)", 
                a: [
                    "ë‹¥í„°ìœ ", "ë‹¥í„°ìœ ë‹˜", "ë‹¥í„°ìœ  ì„ ìƒë‹˜", "ë‹¥í„°ìœ ìŒ¤", 
                    "ë‹¥í„°ìœ  ì˜ìƒ", "ë‹¥í„°ìœ ë‹˜ ì˜ìƒ", "ë‹¥í„°ìœ  ì„ ìƒë‹˜ ì˜ìƒ", 
                    "ë‹¥í„°ìœ  ìœ íŠœë¸Œ", "ë‹¥í„°ìœ ë‹˜ ìœ íŠœë¸Œ", "ë‹¥í„°ìœ  ì„ ìƒë‹˜ ìœ íŠœë¸Œ", "ë‹¥í„°ìœ ìŒ¤ ìœ íŠœë¸Œ", 
                    "ìœ íŠœë¸Œ ë‹¥í„°ìœ ì™€ í•¨ê»˜", 
                    "ë‹¥í„°ìœ  ìœ íŠœë¸Œ ì˜ìƒ", "ë‹¥í„°ìœ ë‹˜ ìœ íŠœë¸Œ ì˜ìƒ", "ë‹¥í„°ìœ  ì„ ìƒë‹˜ ìœ íŠœë¸Œ ì˜ìƒ", "ë‹¥í„°ìœ ìŒ¤ ìœ íŠœë¸Œ ì˜ìƒ",
                    "ìœ íŠœë¸Œ ë‹¥í„°ìœ ", "ìœ íŠœë¸Œ ë‹¥í„°ìœ ë‹˜", "ìœ íŠœë¸Œ ë‹¥í„°ìœ  ì„ ìƒë‹˜", "ìœ íŠœë¸Œ ë‹¥í„°ìœ ìŒ¤",
                    "ìœ íŠœë¸Œ ë‹¥í„°ìœ  ì˜ìƒ", "ìœ íŠœë¸Œ ë‹¥í„°ìœ ë‹˜ ì˜ìƒ", "ìœ íŠœë¸Œ ë‹¥í„°ìœ  ì„ ìƒë‹˜ ì˜ìƒ", "ìœ íŠœë¸Œ ë‹¥í„°ìœ ìŒ¤ ì˜ìƒ", "ë‹¥í„°ìœ  ìœ íƒœìš°", "ìœ íƒœìš°",
                    "ìœ íƒœìš°ë‹˜", "ìœ íƒœìš° ì„ ìƒë‹˜", "ìœ íƒœìš°ìŒ¤", "ìœ íƒœìš° ì˜ìƒ", "ìœ íƒœìš°ë‹˜ ì˜ìƒ", "ìœ íƒœìš° ì„ ìƒë‹˜ ì˜ìƒ",
                    "ìœ íƒœìš° ìœ íŠœë¸Œ", "ìœ íƒœìš°ë‹˜ ìœ íŠœë¸Œ", "ìœ íƒœìš° ì„ ìƒë‹˜ ìœ íŠœë¸Œ", "ìœ íƒœìš°ìŒ¤ ìœ íŠœë¸Œ"
                ],
                fa: "ë‹¥í„°U"
            },
            { q: "ê¹€ì¬ì›ì˜ ì˜¤ë„ˆ ìºë¦­í„°ì˜ ì´ë¦„ì€?", c: "", a: ["ê¹€ì¬ì¼"], fa: "ê¹€ì¬ì¼" },
            { q: "ê¹€ì¬ì›ì˜ ì¦ê±°ìš´ ì„¸ìƒ ì±„ë„ì˜ URLì€<br>https://www.youtube.com/ (ë¬¸ìì—´ ğ´) ì´ë‹¤.<br>ì´ë•Œ ë¬¸ìì—´ ğ´ì˜ ê¸€ì ìˆ˜ëŠ”?", c: "", a: ["15"], fa: "16" },
            { q: "ê¹€ì¬ì›ì´ ë‹¤ë…”ë˜ í•™êµì˜ ìˆ˜ëŠ”?", c: "", a: ["4"], fa: "5" },
            { q: "ë‚˜ë¬´ìœ„í‚¤ ë¬¸ì„œì— ë“±ë¡ëœ ê¹€ì¬ì› ì‚¬ì§„ì´ ë°”ë¼ë³´ê³  ìˆëŠ” ë°©í–¥ì€?", c: "", a: ["ì˜¤ë¥¸ìª½"], fa: "ì™¼ìª½" }
        ];

        const normalQuestions = [
            { q: "ê¹€ì¬ì¼ ì…ìˆ ì˜ HEX ì½”ë“œëŠ”?", c: "(ë‹¨, #ì€ ì“°ì§€ ì•Šìœ¼ë©°, ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•œë‹¤.)", a: ["EC1C24"], fa: "E81D26" },
            { q: "ê¹€ì¬ì›ì´ íƒ„ìƒí•œ ë‚˜ë¼ì˜ êµ­ê°€ì˜ ì‘ê³¡ê°€ëŠ”?", c: "", a: ["ì•ˆìµíƒœ"], fa: "í™ë‚œíŒŒ" },
            { q: "ê¹€ì¬ì›ì˜ íŒ¬ì¹´í˜ <ê¹€ì¬ì› íœì¹´í˜ì„>ì˜ ê°œì„¤ ë‚ ì§œëŠ”?", c: "(ë‹¨, 8ìë¦¬ë¡œ ì“´ë‹¤.)", a: ["20161226"], fa: "20161225" },
            { q: "2021ë…„ 8ì›” 20ì¼ì— ê¹€ì¬ì›ì˜ ì¦ê±°ìš´ ì„¸ìƒ ì±„ë„ì— ì˜¬ë¼ì˜¨ ì˜ìƒì˜ ê¸¸ì´ë¥¼ ğ‘ë¶„ ğ‘ì´ˆë¼ê³  í•˜ì. (8,2)<br>ì´ë•Œ ë°©ì •ì‹ 3ğ‘ + 2ğ‘ = ğ‘ğ‘ + ğ‘ğ‘¥ì—ì„œ ğ‘¥ì˜ ê°’ì€?", c: "", a: ["6"], fa: "5" },
            { q: "2024ë…„ 4ì›” 3ì¼ì— ê¹€ì¬ì›ì˜ ì¦ê±°ìš´ ì„¸ìƒ ì±„ë„ì— ì˜¬ë¼ì˜¨ ì˜ìƒì˜ ì¸ë„¤ì¼ì— ë…¸ë€ìƒ‰ìœ¼ë¡œ ì íŒ í…ìŠ¤íŠ¸ ì¤‘ ì„¸ ë²ˆì§¸ ê¸€ìëŠ”?", c: "", a: ["ë¦„"], fa: "êµ¬" }
        ];

        const hardQuestions = [
            { q: "2019ë…„ 4ì›” 14ì¼ ê¹€ì¬ì›ì˜ ì¦ê±°ìš´ ì„¸ìƒ ì±„ë„ì— ì˜¬ë¼ì˜¨ ì˜ìƒì˜ ì œëª©ì˜ ê¸€ì ìˆ˜ë¥¼ ğ‘, ì˜ìƒì˜ ê¸¸ì´ë¥¼ ğ‘ë¶„ ğ‘ì´ˆë¼ê³  í•˜ì<br>ì´ë•Œ í•¨ìˆ˜ ğ‘“(ğ‘¥) = ğ‘ğ‘¥Â² + ğ‘ğ‘¥ + ğ‘ ì— ëŒ€í•˜ì—¬ (24, 22, 49)<br>ë°©ì •ì‹ ğ‘“(ğ‘¥) = 37 ì˜ ë‘ ì‹¤ê·¼ì˜ í‰ê· ì„ ğ‘˜ë¼ê³  í•˜ì.<br>ì´ë•Œ ğ‘“'(ğ‘˜) ì˜ ê°’ì€?", c: "(ë‹¨, ì œëª©ì˜ ê³µë°±ì€ ìƒê°í•˜ì§€ ì•ŠëŠ”ë‹¤.)", a: ["0"], fa: "1" },
            { q: "ê¹€ì¬ì›ì´ ì¡¸ì—…í•œ ê³ ë“±í•™êµì˜ êµê°€ì˜ ì‘ê³¡ê°€ëŠ” í•´ë‹¹ í•™êµì˜ ì œ ğ‘›ëŒ€ êµì¥ì´ë‹¤. ì´ë•Œ ì´ë¶„ê»˜ì„œ êµì¥ìœ¼ë¡œ ì·¨ì„ëœ ë‚ ì§œë¡œë¶€í„° ğ‘›ì¼ ë’¤ì™€ ê¹€ì¬ì›ì˜ ì…ëŒ€ ë‚ ì§œì˜ ì°¨ëŠ”?", c: "(ë‹¨, ì‹œì‘ ë‚ ì§œë„ í¬í•¨í•˜ë©°, ë©°ì¹ ì¸ì§€ ìˆ«ìë§Œ ì“´ë‹¤.)", a: ["14682"], fa: "14681" },
            { q: "ê¹€ì¬ì›ì˜ ì¹˜ì§€ì§ ì±„ë„ ì§€ì¡´ì§±ì§±ê¹€ì¬ì›ì„¼ì„¸ì˜ URLì€ https://chzzk.naver.com/ (ë¬¸ìì—´ ğ´) ì´ë‹¤.<br>ì´ë•Œ ë¬¸ìì—´ ğ´ì˜ ê¸€ì ìˆ˜ì™€ ê°€ì¥ ë§ì´ ë‚˜ì˜¨ ì•ŒíŒŒë²³ì„ ìˆœì„œëŒ€ë¡œ ì“°ë©´?", c: "(ë‹¨, ê°™ì€ íšŸìˆ˜ë¡œ ë‚˜ì˜¨ ì•ŒíŒŒë²³ì€ ìˆœì„œê°€ ë¹ ë¥¸ ê²ƒìœ¼ë¡œ í•˜ë©°, ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•œë‹¤.)", a: ["32a"], fa: "32d" },
            { q: "2018ë…„ 10ì›” 21ì¼ì— ê¹€ì¬ì›ì˜ ì¦ê±°ìš´ ì„¸ìƒ ì±„ë„ì— ì˜¬ë¼ì˜¨ ì˜ìƒì˜ ì¸ë„¤ì¼ì— ì íŒ ê¸€ìì˜ ìˆ˜ë¥¼ ëª¨ìŠ¤ë¶€í˜¸ë¡œ ë°”ê¾¸ì—ˆì„ ë•Œ, ì§§ì€ ì‹ í˜¸ì˜ ê°œìˆ˜ëŠ”?", c: "", a: ["6"], fa: "7" },
            { q: "ê¹€ì¬ì›ì´ ì¡¸ì—…í•œ ì¤‘í•™êµì˜ êµí›ˆì˜ ê¸€ì ìˆ˜ë¥¼ ëª¨ìŠ¤ë¶€í˜¸ë¡œ ë‚˜íƒ€ë‚´ì—ˆì„ ë•Œ, ëª¨ìŠ¤ë¶€í˜¸ì˜ ê¸€ì ìˆ˜ëŠ”?", c: "(ë‹¨, êµí›ˆì˜ ê³µë°±ì€ ì„¸ì§€ ì•ŠëŠ”ë‹¤.)", a: ["5"], fa: "4" }
        ];

        let currentQuestions = [];
        let currentIndex = 0;
        let lives = 2;
        let timerInterval;
        let timeLeft = 60;
        let currentTimeLimit = 60; 
        let isDead = false;
        let currentMode = '';
        let hasErrorOccurred = false; 
        
        let cheatCount = 0; 
        let isCheatUsedForCurrentQuestion = false;
        let caughtCount = 0;

        function openHowTo() { document.getElementById('howto-modal').classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }
        function openDifficulty() { document.getElementById('diff-modal').classList.remove('hidden'); }

        const volSlider = document.getElementById('vol-slider');
        const audioIds = ['bgm', 'sfx-wrong', 'sfx-dead', 'sfx-ending', 'sfx-volume'];

        function setAudioVolume(level) {
            audioIds.forEach(id => {
                const audio = document.getElementById(id);
                if (audio) audio.volume = level;
            });
        }

        setAudioVolume(0.5);

        volSlider.addEventListener('input', function() {
            const vol = this.value;
            setAudioVolume(vol);
            const volSfx = document.getElementById('sfx-volume');
            if (volSfx) {
                if (volSfx.paused) {
                    volSfx.play().catch(e => {}); 
                }
            }
        });

        function startGame(mode) {
            closeModal('diff-modal');
            document.getElementById('ending-screen').classList.add('hidden');
            
            const volSfx = document.getElementById('sfx-volume');
            if (volSfx) {
                volSfx.pause();
                volSfx.currentTime = 0;
            }

            currentMode = mode;
            currentTimeLimit = 60;
            hasErrorOccurred = false;
            lives = 2; 
            cheatCount = 0;
            caughtCount = 0;
            updateDamageVisuals();

            const bgm = document.getElementById('bgm');
            bgm.src = "https://raw.githubusercontent.com/o-mega-0/KJW_Volume/main/Volume.mp3";
            bgm.loop = true;
            bgm.play().catch(e => console.log("Audio play failed:", e));

            document.getElementById('start-scene').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('start-scene').classList.add('hidden');
                document.getElementById('game-scene').style.display = 'block';
                document.getElementById('quiz-paper').classList.remove('hidden');
            }, 500);

            const specificQuestions = mode === 'normal' ? normalQuestions : hardQuestions;
            currentQuestions = [...commonQuestions, ...specificQuestions];
            currentIndex = 0;
            isDead = false;
            
            loadQuestion();
        }

        function loadQuestion() {
            if (isDead) return;
            clearInterval(timerInterval);
            timeLeft = currentTimeLimit;
            updateTimerDisplay();
            isCheatUsedForCurrentQuestion = false;
            document.getElementById('cheat-paper').style.display = 'none'; 
            timerInterval = setInterval(timerTick, 1000);

            const qData = currentQuestions[currentIndex];
            document.getElementById('q-num').innerText = currentIndex + 1;
            document.getElementById('q-text').innerHTML = qData.q;
            document.getElementById('q-condition').innerText = qData.c;
            
            const input = document.getElementById('answer-input');
            input.value = '';
            input.focus();
        }

        function openCheatSheet() {
            if (isDead || isCheatUsedForCurrentQuestion) return;

            const catchChance = (cheatCount + 1) * 0.1;
            
            if (Math.random() < catchChance) {
                handleCaught();
            } else {
                cheatCount++;
                isCheatUsedForCurrentQuestion = true;
                
                const qData = currentQuestions[currentIndex];
                const showFake = Math.random() < 0.2;
                const answerToShow = showFake ? qData.fa : qData.a[0];

                document.getElementById('cheat-q-text').innerHTML = qData.q;
                document.getElementById('cheat-q-condition').innerText = qData.c;
                document.getElementById('cheat-answer-display').innerText = answerToShow;
                document.getElementById('cheat-paper').style.display = 'block';
            }
        }

        function closeCheatSheet() {
            document.getElementById('cheat-paper').style.display = 'none';
        }

        function handleCaught() {
            clearInterval(timerInterval);
            isCheatUsedForCurrentQuestion = true;
            caughtCount++;
            
            lives--;
            updateDamageVisuals();

            currentTimeLimit = 20;
            
            timeLeft = currentTimeLimit;
            updateTimerDisplay();

            if (!hasErrorOccurred) {
                hasErrorOccurred = true;
                const bgm = document.getElementById('bgm');
                bgm.src = "https://raw.githubusercontent.com/o-mega-0/KJW_Background-Sound/main/Background%20Sound.mp3";
                bgm.play().catch(e => {});
            }

            let soundId;
            let isGameOver = false;

            if (lives <= 0) {
                isDead = true;
                soundId = 'sfx-dead';
                isGameOver = true;
            } else {
                soundId = 'sfx-wrong';
            }

            const sfx = document.getElementById(soundId);
            sfx.currentTime = 0;
            sfx.play();

            showJumpScare("caught.png", isGameOver);
        }

        function timerTick() {
            timeLeft--;
            updateTimerDisplay();
            if (timeLeft <= 0) {
                handleWrong("timeover");
            }
        }

        function updateTimerDisplay() {
            const timerEl = document.getElementById('timer-ui');
            timerEl.innerText = timeLeft;
            if (timeLeft <= 10) timerEl.classList.add('warning');
            else timerEl.classList.remove('warning');
        }

        function checkAnswer() {
            if (isDead) return;
            const input = document.getElementById('answer-input').value.trim().replace(/\s+/g, '');
            const correctAnswers = currentQuestions[currentIndex].a;
            
            const isCorrect = correctAnswers.some(ans => ans.replace(/\s+/g, '') === input);

            if (isCorrect) {
                currentIndex++;
                if (currentIndex >= currentQuestions.length) {
                    showClear();
                } else {
                    loadQuestion();
                }
            } else {
                handleWrong("wrong");
            }
        }

        function handleWrong(reason) {
            clearInterval(timerInterval);
            lives--;
            const inputEl = document.getElementById('answer-input');
            inputEl.value = '';
            
            updateDamageVisuals();

            if (!hasErrorOccurred) {
                hasErrorOccurred = true;
                const bgm = document.getElementById('bgm');
                bgm.src = "https://raw.githubusercontent.com/o-mega-0/KJW_Background-Sound/main/Background%20Sound.mp3";
                bgm.play().catch(e => {});
            }
            
            document.getElementById('game-scene').classList.add('shake');
            setTimeout(() => document.getElementById('game-scene').classList.remove('shake'), 500);

            if (lives <= 0) {
                isDead = true;
                const deadSfx = document.getElementById('sfx-dead');
                deadSfx.currentTime = 0;
                deadSfx.play();
                showJumpScare("dead.png", true);
            } else {
                const wrongSfx = document.getElementById('sfx-wrong');
                wrongSfx.currentTime = 0;
                wrongSfx.play();
                
                if (reason === "timeover") {
                    currentTimeLimit = Math.max(1, Math.floor(currentTimeLimit / 4));
                    showJumpScare("slow.png", false);
                } else {
                    showJumpScare("wrong-answer.png", false);
                }
            }
        }

        function updateDamageVisuals() {
            const damageOverlay = document.getElementById('damage-overlay');
            const gameContent = document.getElementById('game-content');
            
            if (lives < 2) { 
                gameContent.classList.add('dark-filter');
            } else {
                gameContent.classList.remove('dark-filter');
            }

            const opacity = (2 - lives) * 0.5;
            damageOverlay.style.opacity = Math.max(0, opacity);
        }

        function showJumpScare(imgSrc, isGameOver) {
            const overlay = document.getElementById('jumpscare-overlay');
            const img = document.getElementById('jumpscare-img');
            img.src = imgSrc;
            overlay.classList.remove('hidden');

            if (isGameOver) {
                setTimeout(() => {
                    overlay.classList.add('hidden');
                    document.getElementById('game-over-screen').style.display = 'flex';
                }, 5000);
            } else {
                setTimeout(() => {
                    overlay.classList.add('hidden');
                    if (imgSrc === 'caught.png') {
                        closeCheatSheet();
                        timerInterval = setInterval(timerTick, 1000); 
                    } else {
                        loadQuestion();
                    }
                }, 4000);
            }
        }

        function retryGame() {
            document.getElementById('game-over-screen').style.display = 'none';
            lives = 2; 
            isDead = false;
            currentTimeLimit = 60;
            cheatCount = 0;
            caughtCount = 0;
            hasErrorOccurred = false;
            currentIndex = 0; 

            const specificQuestions = currentMode === 'normal' ? normalQuestions : hardQuestions;
            currentQuestions = [...commonQuestions, ...specificQuestions];

            updateDamageVisuals();

            const bgm = document.getElementById('bgm');
            bgm.src = "https://raw.githubusercontent.com/o-mega-0/KJW_Volume/main/Volume.mp3";
            bgm.loop = true;
            bgm.play().catch(e => console.log("Audio play failed:", e));

            loadQuestion();
        }

        document.getElementById('answer-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') checkAnswer();
        });
        
        function showClear() {
            clearInterval(timerInterval);
            
            const bgm = document.getElementById('bgm');
            const endingSfx = document.getElementById('sfx-ending');
            bgm.pause();
            endingSfx.play().catch(e => console.log("Ending audio play failed:", e));

            const otherBtn = document.getElementById('other-diff-btn');
            if (currentMode === 'normal') {
                otherBtn.innerText = "Hard ë‚œì´ë„ í”Œë ˆì´í•˜ê¸°";
                otherBtn.onclick = function() { startGame('hard'); };
                otherBtn.classList.add('text-red-400', 'border-red-400');
            } else {
                otherBtn.innerText = "Normal ë‚œì´ë„ í”Œë ˆì´í•˜ê¸°";
                otherBtn.onclick = function() { startGame('normal'); };
                otherBtn.classList.remove('text-red-400', 'border-red-400');
                otherBtn.classList.add('text-gray-300', 'border-gray-400');
            }

            document.getElementById('ending-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>
















